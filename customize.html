<!DOCTYPE html>
<!--
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                      CITYBLOCKS CUSTOMIZE PAGE                             ‚ïë
‚ïë                       customize.html - VERSION 1.1                         ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìÖ DATE: November 9, 2025
üë§ DEVELOPER: Richard Tucker (Batman1997)
üè¢ PROJECT: CityBlocks.com - Brownstone Customization Tool
üåê DOMAIN: Premium domain since 1997 | Retirement project for Adobe pitch

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

VERSION HISTORY:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
v1.1 (Nov 9, 2025) - FILE STRUCTURE REORGANIZATION
  ‚úÖ Updated all image paths to use /images/ folder
  ‚úÖ Fixed: city-street-background.jpg ‚Üí images/city-street-background.jpg
  ‚úÖ Fixed: Brownstone_control_panel_concept.png ‚Üí images/Brownstone_control_panel_concept.png
  ‚úÖ Fixed: walls_only.png ‚Üí images/walls_only.png (CSS and JavaScript)
  ‚úÖ Organized GitHub: /images, /videos, /audio folders created
  ‚öôÔ∏è STATUS: Ready for deployment - all paths corrected

v1.0 (Nov 9, 2025) - FENG SHUI COLOR FACELIFT
  ‚úÖ Converted from dark blue/purple theme to warm Feng Shui colors
  ‚úÖ Warm cream background (#F5F1E8)
  ‚úÖ Gold accent colors (#d4af37) throughout
  ‚úÖ Brown gradient control panels
  ‚úÖ Gold tab navigation and buttons
  ‚úÖ Matching homepage color palette

v0.9 - INITIAL CUSTOMIZATION FEATURES
  ‚úÖ Color picker with 9 preset colors
  ‚úÖ Upload custom images/patterns
  ‚úÖ Opacity and saturation sliders
  ‚úÖ 3-layer brownstone system (full, walls-only mask, color overlay)
  ‚úÖ Live preview
  ‚úÖ "Claim Your Brownstone" export feature

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

CURRENT STATUS:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚úÖ Color scheme matches homepage (Feng Shui prosperity theme)
‚úÖ File structure organized (/images folder)
‚úÖ All image paths corrected
‚úÖ Customization tools working (colors, uploads, sliders)
‚è≥ Next: Test desaturated brownstone with transparent background
‚è≥ Next: Fine-tune color overlay alignment

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

FILE DEPENDENCIES:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Required in /images/ folder:
  ‚îú‚îÄ‚îÄ Brownstone_control_panel_concept.png (Desaturated brownstone - 832x1500px)
  ‚îú‚îÄ‚îÄ city-street-background.jpg (Background overlay)
  ‚îî‚îÄ‚îÄ walls_only.png (Mask for color overlay - walls only, transparent elsewhere)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

HOW IT WORKS:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
3-Layer System:
  Layer 1: Full desaturated brownstone (base image)
  Layer 2: Masked color layer (only affects walls via walls_only.png mask)
  Layer 3: User's color choice or uploaded image

Result: Only brick walls change color - architectural details stay gray!

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

COLOR PALETTE (Matches Homepage):
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üé® Background: #F5F1E8 (Warm cream)
üåü Gold: #d4af37 (Primary accent)
üè¢ Brown: #4a2c1f (Text and borders)
ü§é Panel: rgba(107, 68, 35, 0.95) ‚Üí rgba(139, 90, 60, 0.95)
üíö Success: #4ade80 (Upload confirmation)
üî¥ Error: #ef4444 (Remove/reset buttons)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

NOTES FOR NEXT SESSION:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚Ä¢ Desaturated brownstone needs transparent background (currently has light gray)
‚Ä¢ Consider adding more preset colors
‚Ä¢ Test color alignment on actual GitHub deployment
‚Ä¢ Link to account.html after "Claim Your Brownstone" button

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CityBlocks - Brownstone Customization</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: #F5F1E8; /* Warm cream - Feng Shui earth/stability */
            background-image: 
                linear-gradient(rgba(245, 241, 232, 0.55), rgba(245, 241, 232, 0.55)),
                url('images/city-street-background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #2c2416;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3rem;
            color: #4a2c1f; /* Dark brownstone brown */
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .tagline {
            font-size: 1.2rem;
            color: #4a2c1f;
            font-style: italic;
        }

        .layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 40px;
            align-items: start;
        }

        .controls {
            background: linear-gradient(135deg, rgba(107, 68, 35, 0.95) 0%, rgba(139, 90, 60, 0.95) 100%);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #4a2c1f;
            position: sticky;
            top: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .tab-navigation {
            display: flex;
            gap: 8px;
            margin-bottom: 25px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.5);
        }

        .tab-btn {
            flex: 1;
            padding: 12px 8px;
            background: transparent;
            color: rgba(255, 255, 255, 0.6);
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            margin-bottom: -2px;
        }

        .tab-btn:hover {
            color: #f5c842;
        }

        .tab-btn.active {
            color: white;
            border-bottom-color: #d4af37;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #ffffff;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        .color-btn {
            aspect-ratio: 1;
            border: 3px solid transparent;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .color-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.6);
        }

        .color-btn.active {
            border-color: white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        }

        .color-label {
            text-align: center;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 5px;
        }

        .slider-group {
            margin-bottom: 25px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .slider-value {
            color: #4ade80;
            font-weight: bold;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #d4af37;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #d4af37;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.6);
            border: none;
        }

        .upload-zone {
            border: 3px dashed rgba(212, 175, 55, 0.5);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-zone:hover {
            border-color: #d4af37;
            background: rgba(212, 175, 55, 0.1);
        }

        .upload-zone.drag-over {
            background: rgba(212, 175, 55, 0.2);
            border-color: #d4af37;
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 5px;
        }

        .upload-hint {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }

        #fileInput {
            display: none;
        }

        .upload-success {
            background: rgba(74, 222, 128, 0.2);
            border: 2px solid #4ade80;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }

        .upload-success.show {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .remove-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s;
        }

        .remove-btn:hover {
            background: #dc2626;
        }

        .action-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d4af37 0%, #f5c842 100%);
            color: #2d5016; /* Dark green text like homepage */
            border: 2px solid #b8941f;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 10px;
            box-shadow: 0 3px 10px rgba(212, 175, 55, 0.5);
            -webkit-text-stroke: 0.5px #000000;
            text-stroke: 0.5px #000000;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.7);
            background: linear-gradient(135deg, #f5c842 0%, #d4af37 100%);
        }

        .action-btn:active {
            transform: translateY(0);
        }

        .reset-btn {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #ef4444;
        }

        .reset-btn:hover {
            background: rgba(239, 68, 68, 0.3);
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
        }

        .preview {
            background: rgba(222, 184, 135, 0.3);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid rgba(212, 175, 55, 0.5);
            backdrop-filter: blur(10px);
        }

        .preview-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .preview-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #4a2c1f;
            font-weight: bold;
        }

        .preview-subtitle {
            color: #4a2c1f;
            font-size: 0.9rem;
        }

        .brownstone-container {
            position: relative;
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(212, 175, 55, 0.3);
        }

        .brownstone-wrapper {
            position: relative;
            width: 100%;
            isolation: isolate;
            overflow: hidden;
            border-radius: 10px;
        }

        #brownstoneBase {
            display: block;
            width: 100%;
            height: auto;
            position: relative;
            z-index: 1;
        }

        #coloredWalls {
            position: absolute;
            top: -10px;
            left: -2px;
            width: 100%;
            height: 100%;
            z-index: 2;
            background-color: #C9936D;
            -webkit-mask-image: url('images/walls_only.png');
            mask-image: url('images/walls_only.png');
            -webkit-mask-size: 100% 100%;
            mask-size: 100% 100%;
            -webkit-mask-repeat: no-repeat;
            mask-repeat: no-repeat;
            -webkit-mask-position: 0 0;
            mask-position: 0 0;
            pointer-events: none;
        }

        .info-box {
            background: rgba(102, 126, 234, 0.1);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .info-title {
            font-size: 1.1rem;
            color: #d4af37;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-list {
            list-style: none;
            padding-left: 0;
        }

        .info-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .info-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #4ade80;
            font-weight: bold;
        }

        .recommended-size {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid rgba(251, 191, 36, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        @media (max-width: 1024px) {
            .layout {
                grid-template-columns: 1fr;
            }

            .controls {
                position: static;
            }

            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>CityBlocks</h1>
            <p class="tagline">Colors & Uploads - Your Brownstone, Your Way</p>
        </header>

        <div class="layout">
            <!-- Controls Panel -->
            <div class="controls">
                <!-- Tab Navigation -->
                <div class="tab-navigation">
                    <button class="tab-btn active" onclick="switchTab('colors')">üé® Colors</button>
                    <button class="tab-btn" onclick="switchTab('upload')">üì∏ Upload</button>
                </div>

                <!-- Colors Tab -->
                <div id="colorsTab" class="tab-content active">
                    <div class="section-title">üé® Preset Colors</div>
                    <div class="color-grid">
                        <div>
                            <div class="color-btn" style="background-color: #dc2626;" onclick="selectColor('#dc2626', 'Red')" data-color="red"></div>
                            <div class="color-label">Red</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #f5f5f5;" onclick="selectColor('#f5f5f5', 'White')" data-color="white"></div>
                            <div class="color-label">White</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #f97316;" onclick="selectColor('#f97316', 'Orange')" data-color="orange"></div>
                            <div class="color-label">Orange</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #3b82f6;" onclick="selectColor('#3b82f6', 'Blue')" data-color="blue"></div>
                            <div class="color-label">Blue</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #10b981;" onclick="selectColor('#10b981', 'Green')" data-color="green"></div>
                            <div class="color-label">Green</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #ec4899;" onclick="selectColor('#ec4899', 'Pink')" data-color="pink"></div>
                            <div class="color-label">Pink</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #8b5cf6;" onclick="selectColor('#8b5cf6', 'Purple')" data-color="purple"></div>
                            <div class="color-label">Purple</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #6b7280;" onclick="selectColor('#6b7280', 'Gray')" data-color="gray"></div>
                            <div class="color-label">Gray</div>
                        </div>
                        <div>
                            <div class="color-btn" style="background-color: #fbbf24;" onclick="selectColor('#fbbf24', 'Yellow')" data-color="yellow"></div>
                            <div class="color-label">Yellow</div>
                        </div>
                    </div>

                    <div class="section-title">üåà Color Hue</div>
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Hue Rotation</span>
                            <span class="slider-value" id="hueValue">0¬∞</span>
                        </div>
                        <input type="range" id="hueSlider" min="0" max="360" value="0" oninput="updateHue(this.value)">
                    </div>

                    <div class="section-title">üòé Intensity</div>
                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Opacity</span>
                            <span class="slider-value" id="opacityValue">25%</span>
                        </div>
                        <input type="range" id="opacitySlider" min="0" max="100" value="25" oninput="updateOpacity(this.value)">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Saturation</span>
                            <span class="slider-value" id="saturationValue">100%</span>
                        </div>
                        <input type="range" id="saturationSlider" min="0" max="200" value="100" oninput="updateSaturation(this.value)">
                    </div>

                    <div class="section-title">üé® Blend Mode</div>
                    <div class="slider-group">
                        <select id="blendMode" onchange="updateBlendMode(this.value)" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(102, 126, 234, 0.3);">
                            <option value="multiply">Multiply (Natural)</option>
                            <option value="overlay">Overlay</option>
                            <option value="screen">Screen</option>
                            <option value="color">Color</option>
                        </select>
                    </div>
                </div>

                <!-- Upload Tab -->
                <div id="uploadTab" class="tab-content">
                    <div class="section-title">üì∏ Upload Your Design</div>
                    
                    <div class="upload-zone" id="uploadZone" onclick="document.getElementById('fileInput').click()">
                        <div class="upload-icon">üì∏</div>
                        <div class="upload-text">Express your creativity!</div>
                        <div class="upload-hint">Upload band logos, artwork, or patterns</div>
                    </div>
                    
                    <input type="file" id="fileInput" accept="image/*" onchange="handleFileSelect(event)">
                    
                    <div class="upload-success" id="uploadSuccess">
                        <span>‚úÖ Image uploaded!</span>
                        <button class="remove-btn" onclick="removeUpload()">Remove</button>
                    </div>

                    <div class="slider-group" style="margin-top: 20px;">
                        <div class="slider-label">
                            <span>Opacity</span>
                            <span class="slider-value" id="uploadOpacityValue">50%</span>
                        </div>
                        <input type="range" id="uploadOpacitySlider" min="0" max="100" value="50" oninput="updateUploadOpacity(this.value)">
                    </div>

                    <div class="slider-group">
                        <div class="slider-label">
                            <span>Saturation</span>
                            <span class="slider-value" id="uploadSaturationValue">100%</span>
                        </div>
                        <input type="range" id="uploadSaturationSlider" min="0" max="200" value="100" oninput="updateUploadSaturation(this.value)">
                    </div>

                    <div class="recommended-size">
                        <span>‚ö†Ô∏è</span>
                        <div>
                            <strong>Recommended Image Size:</strong><br>
                            800 x 1200 pixels for best results
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <button class="action-btn" onclick="claimBrownstone(event)">üè† Claim Your Brownstone</button>
                <button class="action-btn" onclick="takeTour()">üö∂ Take a Tour</button>
                <button class="action-btn reset-btn" onclick="resetToDefault()">üîÑ Reset to Default</button>
            </div>

            <!-- Preview Panel -->
            <div class="preview">
                <div class="preview-header">
                    <div class="preview-title">Live Preview</div>
                    <div class="preview-subtitle">Only the brick walls change color - roof and entryway stay gray!</div>
                </div>

                <div class="brownstone-container">
                    <div class="brownstone-wrapper">
                        <img id="brownstoneBase" src="images/Brownstone_control_panel_concept.png" alt="Brownstone Base">
                        <div id="coloredWalls"></div>
                    </div>
                </div>

                <div class="info-box">
                    <div class="info-title">üé® 3-Layer System:</div>
                    <ul class="info-list">
                        <li><strong>Layer 1:</strong> Full brownstone (roof, windows, entryway stay gray)</li>
                        <li><strong>Layer 2:</strong> Brick walls only (transparent PNG)</li>
                        <li><strong>Layer 3:</strong> Color overlay (paints the walls!)</li>
                        <li><strong>Result:</strong> Only the walls change color!</li>
                    </ul>
                </div>

                <div class="info-box" style="margin-top: 15px;">
                    <div class="info-title">üè† CityBlocks</div>
                    <div style="color: #888; margin-top: 10px;">Where Creators Collaborate</div>
                    <div style="color: #4ade80; margin-top: 10px; font-style: italic;">"You can own a brownstone... on CityBlocks dot com"</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State variables - DEFAULT TO TAN AT 25% OPACITY
        let currentMode = 'colors';
        let currentColor = '#C9936D';
        let currentName = 'Natural Tan';
        let currentHue = 0;
        let currentOpacity = 25;
        let currentSaturation = 100;
        let currentBlendMode = 'multiply';
        let uploadedImageUrl = null;
        let currentUploadOpacity = 50;
        let currentUploadSaturation = 100;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateWallColor();
            
            // Set up drag and drop for upload zone
            const uploadZone = document.getElementById('uploadZone');
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('drag-over');
            });
            
            uploadZone.addEventListener('dragleave', () => {
                uploadZone.classList.remove('drag-over');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('drag-over');
                
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    handleFile(file);
                }
            });
        });

        // Tab switching
        function switchTab(tabName) {
            currentMode = tabName;
            
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // Update wall display
            updateWallColor();
        }

        // Color selection
        function selectColor(color, name) {
            currentColor = color;
            currentName = name;
            currentMode = 'colors';
            
            // Update active state
            document.querySelectorAll('.color-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateWallColor();
        }

        // Hue adjustment
        function updateHue(value) {
            currentHue = parseInt(value);
            document.getElementById('hueValue').textContent = value + '¬∞';
            updateWallColor();
        }

        // Opacity adjustment
        function updateOpacity(value) {
            currentOpacity = parseInt(value);
            document.getElementById('opacityValue').textContent = value + '%';
            updateWallColor();
        }

        // Saturation adjustment
        function updateSaturation(value) {
            currentSaturation = parseInt(value);
            document.getElementById('saturationValue').textContent = value + '%';
            updateWallColor();
        }

        // Blend mode
        function updateBlendMode(value) {
            currentBlendMode = value;
            updateWallColor();
        }

        // File upload handling
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('Please upload an image file');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                uploadedImageUrl = e.target.result;
                document.getElementById('uploadSuccess').classList.add('show');
                currentMode = 'upload';
                updateWallColor();
            };
            reader.readAsDataURL(file);
        }

        function removeUpload() {
            uploadedImageUrl = null;
            document.getElementById('uploadSuccess').classList.remove('show');
            document.getElementById('fileInput').value = '';
            currentMode = 'colors';
            updateWallColor();
        }

        function updateUploadOpacity(value) {
            currentUploadOpacity = parseInt(value);
            document.getElementById('uploadOpacityValue').textContent = value + '%';
            updateWallColor();
        }

        function updateUploadSaturation(value) {
            currentUploadSaturation = parseInt(value);
            document.getElementById('uploadSaturationValue').textContent = value + '%';
            updateWallColor();
        }

        // Update the wall color display
        function updateWallColor() {
            const coloredWalls = document.getElementById('coloredWalls');
            
            if (currentMode === 'upload' && uploadedImageUrl) {
                // Upload mode
                coloredWalls.style.backgroundImage = `url('${uploadedImageUrl}')`;
                coloredWalls.style.backgroundColor = 'transparent';
                coloredWalls.style.backgroundSize = 'cover';
                coloredWalls.style.backgroundPosition = 'center';
                coloredWalls.style.backgroundRepeat = 'no-repeat';
                coloredWalls.style.opacity = currentUploadOpacity / 100;
                coloredWalls.style.filter = `saturate(${currentUploadSaturation}%)`;
                coloredWalls.style.mixBlendMode = 'multiply';
                coloredWalls.style.maskImage = `url('images/walls_only.png')`;
                coloredWalls.style.webkitMaskImage = `url('images/walls_only.png')`;
            } else {
                // Color mode
                let color = currentColor;
                
                // Apply hue rotation
                if (currentHue !== 0) {
                    const hsl = hexToHSL(currentColor);
                    hsl.h = (hsl.h + currentHue) % 360;
                    color = HSLToHex(hsl.h, hsl.s, hsl.l);
                }
                
                // Apply saturation
                if (currentSaturation !== 100) {
                    const hsl = hexToHSL(color);
                    hsl.s = (hsl.s * currentSaturation) / 100;
                    if (hsl.s > 100) hsl.s = 100;
                    color = HSLToHex(hsl.h, hsl.s, hsl.l);
                }
                
                coloredWalls.style.backgroundImage = 'none';
                coloredWalls.style.backgroundColor = color;
                coloredWalls.style.opacity = currentOpacity / 100;
                coloredWalls.style.filter = 'none';
                coloredWalls.style.mixBlendMode = currentBlendMode;
                coloredWalls.style.maskImage = `url('images/walls_only.png')`;
                coloredWalls.style.webkitMaskImage = `url('images/walls_only.png')`;
            }
        }

        // Color conversion utilities
        function hexToHSL(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            let r = parseInt(result[1], 16) / 255;
            let g = parseInt(result[2], 16) / 255;
            let b = parseInt(result[3], 16) / 255;

            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            return {
                h: Math.round(h * 360),
                s: Math.round(s * 100),
                l: Math.round(l * 100)
            };
        }

        function HSLToHex(h, s, l) {
            s /= 100;
            l /= 100;

            const c = (1 - Math.abs(2 * l - 1)) * s;
            const x = c * (1 - Math.abs((h / 60) % 2 - 1));
            const m = l - c / 2;
            let r = 0, g = 0, b = 0;

            if (0 <= h && h < 60) {
                r = c; g = x; b = 0;
            } else if (60 <= h && h < 120) {
                r = x; g = c; b = 0;
            } else if (120 <= h && h < 180) {
                r = 0; g = c; b = x;
            } else if (180 <= h && h < 240) {
                r = 0; g = x; b = c;
            } else if (240 <= h && h < 300) {
                r = x; g = 0; b = c;
            } else if (300 <= h && h < 360) {
                r = c; g = 0; b = x;
            }

            r = Math.round((r + m) * 255);
            g = Math.round((g + m) * 255);
            b = Math.round((b + m) * 255);

            return '#' + [r, g, b].map(x => {
                const hex = x.toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }

        // Function to generate and publish a brownstone page
        async function claimBrownstone(event) {
            const originalButtonText = event.target.textContent;
            event.target.textContent = 'üé® Generating Your Page...';
            event.target.style.pointerEvents = 'none';
            
            try {
                const modeName = currentMode === 'colors' ? currentName : 'Custom';
                const timestamp = new Date().toLocaleDateString('en-US', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                
                const compositeImageData = await generateCompositeImage();
                
                const pageHTML = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My CityBlocks Brownstone - ${modeName}</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            color: white;
        }
        .container { max-width: 900px; width: 100%; }
        h1 {
            text-align: center;
            font-size: 3rem;
            margin-bottom: 10px;
            color: #4a2c1f;
        }
        .design-name {
            text-align: center;
            font-size: 1.5rem;
            color: #4ade80;
            font-style: italic;
            margin-bottom: 10px;
        }
        .timestamp { text-align: center; color: #888; margin-bottom: 40px; font-size: 0.9rem; }
        .brownstone-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(212, 175, 55, 0.3);
            margin-bottom: 30px;
        }
        .brownstone-image { display: block; width: 100%; height: auto; border-radius: 10px; }
        .footer { text-align: center; color: #888; }
        .footer p { margin: 10px 0; }
        .footer a { color: #d4af37; text-decoration: none; font-weight: 600; }
        .footer a:hover { color: #f5c842; }
    </style>
</head>
<body>
    <div class="container">
        <h1>My CityBlocks Brownstone</h1>
        <div class="design-name">"${modeName}" Design</div>
        <div class="timestamp">Created on ${timestamp}</div>
        <div class="brownstone-container">
            <img src="${compositeImageData}" alt="My Customized Brownstone" class="brownstone-image">
        </div>
        <div class="footer">
            <p><strong>CityBlocks</strong> - Where Creators Collaborate</p>
            <p><em>"You can own a brownstone... on CityBlocks dot com"</em></p>
            <p><a href="https://operationbrownstone.vercel.app">‚Üê Customize Another Brownstone</a></p>
        </div>
    </div>
</body>
</html>`;
                
                const blob = new Blob([pageHTML], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                window.open(url, '_blank');
                
                setTimeout(() => {
                    event.target.textContent = '‚úÖ Page Generated!';
                    setTimeout(() => {
                        event.target.textContent = originalButtonText;
                        event.target.style.pointerEvents = 'auto';
                    }, 2000);
                }, 500);
                
            } catch (error) {
                console.error('Error generating page:', error);
                event.target.textContent = '‚ùå Error - Try Again';
                setTimeout(() => {
                    event.target.textContent = originalButtonText;
                    event.target.style.pointerEvents = 'auto';
                }, 2000);
            }
        }
        
        async function generateCompositeImage() {
            return new Promise((resolve, reject) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const baseImg = new Image();
                baseImg.crossOrigin = 'anonymous';
                
                baseImg.onload = () => {
                    canvas.width = baseImg.width;
                    canvas.height = baseImg.height;
                    ctx.drawImage(baseImg, 0, 0);
                    
                    const maskImg = new Image();
                    maskImg.crossOrigin = 'anonymous';
                    
                    maskImg.onload = () => {
                        const maskCanvas = document.createElement('canvas');
                        maskCanvas.width = canvas.width;
                        maskCanvas.height = canvas.height;
                        const maskCtx = maskCanvas.getContext('2d');
                        maskCtx.drawImage(maskImg, 0, 0, canvas.width, canvas.height);
                        const maskData = maskCtx.getImageData(0, 0, canvas.width, canvas.height);
                        
                        if (currentMode === 'upload' && uploadedImageUrl) {
                            applyUploadWithMask(ctx, maskData, uploadedImageUrl, currentUploadOpacity, currentUploadSaturation)
                                .then(() => resolve(canvas.toDataURL('image/png')))
                                .catch(() => resolve(canvas.toDataURL('image/png')));
                        } else {
                            applyColorWithMask(ctx, maskData, currentColor, currentOpacity, currentHue, currentSaturation);
                            resolve(canvas.toDataURL('image/png'));
                        }
                    };
                    
                    maskImg.onerror = () => resolve(canvas.toDataURL('image/png'));
                    maskImg.src = 'walls_only.png';
                };
                
                baseImg.onerror = () => reject(new Error('Failed to load base image'));
                baseImg.src = 'brownstone_desaturated.jpg';
            });
        }
        
        function applyColorWithMask(ctx, maskData, color, opacity, hue, saturation) {
            let finalColor = color;
            if (hue !== 0) {
                const hsl = hexToHSL(color);
                hsl.h = (hsl.h + parseInt(hue)) % 360;
                finalColor = HSLToHex(hsl.h, hsl.s, hsl.l);
            }
            if (saturation !== 100) {
                const hsl = hexToHSL(finalColor);
                hsl.s = (hsl.s * saturation) / 100;
                if (hsl.s > 100) hsl.s = 100;
                finalColor = HSLToHex(hsl.h, hsl.s, hsl.l);
            }
            
            const r = parseInt(finalColor.slice(1, 3), 16);
            const g = parseInt(finalColor.slice(3, 5), 16);
            const b = parseInt(finalColor.slice(5, 7), 16);
            const alpha = opacity / 100;
            
            const imgData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
            const pixels = imgData.data;
            const maskPixels = maskData.data;
            
            for (let i = 0; i < pixels.length; i += 4) {
                if (maskPixels[i + 3] > 128) {
                    pixels[i] = pixels[i] * (r / 255) * alpha + pixels[i] * (1 - alpha);
                    pixels[i + 1] = pixels[i + 1] * (g / 255) * alpha + pixels[i + 1] * (1 - alpha);
                    pixels[i + 2] = pixels[i + 2] * (b / 255) * alpha + pixels[i + 2] * (1 - alpha);
                }
            }
            
            ctx.putImageData(imgData, 0, 0);
        }
        
        async function applyUploadWithMask(ctx, maskData, imageUrl, opacity, saturation) {
            return new Promise((resolve) => {
                const img = new Image();
                img.crossOrigin = 'anonymous';
                
                img.onload = () => {
                    const imgData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
                    const pixels = imgData.data;
                    const maskPixels = maskData.data;
                    
                    const tempCanvas = document.createElement('canvas');
                    tempCanvas.width = ctx.canvas.width;
                    tempCanvas.height = ctx.canvas.height;
                    const tempCtx = tempCanvas.getContext('2d');
                    tempCtx.drawImage(img, 0, 0, ctx.canvas.width, ctx.canvas.height);
                    const uploadData = tempCtx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);
                    const uploadPixels = uploadData.data;
                    
                    const alpha = opacity / 100;
                    
                    for (let i = 0; i < pixels.length; i += 4) {
                        if (maskPixels[i + 3] > 128) {
                            pixels[i] = pixels[i] * (uploadPixels[i] / 255) * alpha + pixels[i] * (1 - alpha);
                            pixels[i + 1] = pixels[i + 1] * (uploadPixels[i + 1] / 255) * alpha + pixels[i + 1] * (1 - alpha);
                            pixels[i + 2] = pixels[i + 2] * (uploadPixels[i + 2] / 255) * alpha + pixels[i + 2] * (1 - alpha);
                        }
                    }
                    
                    ctx.putImageData(imgData, 0, 0);
                    resolve();
                };
                
                img.onerror = () => resolve();
                img.src = imageUrl;
            });
        }

        function takeTour() {
            alert('Tour feature coming soon! This will showcase example brownstones from different creators.');
        }

        // Reset to default - TAN AT 25% OPACITY
        function resetToDefault() {
            currentColor = '#C9936D';
            currentName = 'Natural Tan';
            currentHue = 0;
            currentOpacity = 25;
            currentSaturation = 100;
            currentBlendMode = 'multiply';
            currentMode = 'colors';
            
            uploadedImageUrl = null;
            currentUploadOpacity = 50;
            currentUploadSaturation = 100;
            
            document.getElementById('hueSlider').value = 0;
            document.getElementById('hueValue').textContent = '0¬∞';
            document.getElementById('opacitySlider').value = 25;
            document.getElementById('opacityValue').textContent = '25%';
            document.getElementById('saturationSlider').value = 100;
            document.getElementById('saturationValue').textContent = '100%';
            document.getElementById('blendMode').value = 'multiply';
            document.getElementById('uploadOpacitySlider').value = 50;
            document.getElementById('uploadOpacityValue').textContent = '50%';
            document.getElementById('uploadSaturationSlider').value = 100;
            document.getElementById('uploadSaturationValue').textContent = '100%';
            document.getElementById('fileInput').value = '';
            document.getElementById('uploadSuccess').classList.remove('show');
            
            document.querySelectorAll('.color-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-btn')[0].classList.add('active');
            document.getElementById('colorsTab').classList.add('active');
            document.getElementById('uploadTab').classList.remove('active');
            
            updateWallColor();
        }
    </script>
</body>
</html>
